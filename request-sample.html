<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Request Material Samples</title>
  <link rel="stylesheet" href="./assets/css/global.css" />
  <style>
    body { font-family: sans-serif; background:#f8fafc; margin:0; padding:40px; }
    .form-wrapper {
      max-width: 800px; margin:0 auto; padding:32px;
      background:#fff; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,.08);
    }
    h1 { margin-top:0; font-size:24px; margin-bottom:8px; }
    p { margin-top:0; color:#555; margin-bottom:24px; }
    .grid { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
    label { display:block; font-size:14px; margin-bottom:6px; }
    input, select, textarea {
      width:100%; padding:10px 12px; font-size:14px;
      border:1px solid #cbd5e1; border-radius:6px; box-sizing:border-box;
    }
    textarea { resize:vertical; min-height:80px; }
    .full { grid-column:1 / -1; }
    button {
      background:#0a7a63; color:#fff; border:none;
      padding:12px 20px; border-radius:6px; cursor:pointer; font-size:15px;
    }
    button:disabled { opacity:0.6; cursor:not-allowed; }
  </style>
</head>
<body>
  <div class="form-wrapper">
    <h1>Request Material Samples</h1>
    <p>Choose your specs and submit. We’ll reply with availability and lead time.</p>

    <form>
      <div class="grid">
        <div>
          <label>Company</label>
          <input type="text" name="company" required />
        </div>
        <div>
          <label>Contact name</label>
          <input type="text" name="contact" required />
        </div>
        <div>
          <label>Email</label>
          <input type="email" name="email" required />
        </div>
        <div>
          <label>Country</label>
          <input type="text" name="country" />
        </div>
        <div>
          <label>Material</label>
          <select name="material">
            <option>Stainless Steel</option>
            <option>Aluminum</option>
            <option>Steel</option>
            <option>Other</option>
          </select>
        </div>
        <div>
          <label>Grade</label>
          <input type="text" name="grade" />
        </div>
        <div>
          <label>Thickness (t)</label>
          <input type="text" name="thickness" />
        </div>
        <div>
          <label>Width (w)</label>
          <input type="text" name="width" />
        </div>
        <div>
          <label>Length (l)</label>
          <input type="text" name="length" />
        </div>
        <div>
          <label>Color</label>
          <input type="text" name="color" />
        </div>
        <div>
          <label>Quantity</label>
          <input type="text" name="quantity" />
        </div>
        <div>
          <label>Finish</label>
          <input type="text" name="finish" />
        </div>
        <div>
          <label>Incoterm</label>
          <input type="text" name="incoterm" />
        </div>
        <div>
          <label>Target deadline</label>
          <input type="text" name="deadline" placeholder="YYYY-MM" />
        </div>
        <div class="full">
          <label>Notes</label>
          <textarea name="notes"></textarea>
        </div>
      </div>
      <div style="margin-top:24px;">
        <button type="submit">Submit request</button>
      </div>
    </form>
  </div>

  <!-- Auto sender script -->
  <script>
  (() => {
    const form = document.querySelector("form");
    if (!form) return;
    const ENDPOINT_DEFAULT = "https://request-sample.damian-kyungho-ha.workers.dev";
    const ENDPOINT = form.dataset.endpoint?.trim() || ENDPOINT_DEFAULT;

    const msgBox = document.createElement("div");
    msgBox.setAttribute("aria-live","polite");
    msgBox.style.marginTop="12px"; msgBox.style.fontSize="14px";
    form.appendChild(msgBox);
    const show = (t,ok=false)=>{ msgBox.textContent=t; msgBox.style.color=ok?"#0a7a63":"#c43d3d"; };

    const formToJSON = (f)=>{
      const all=f.querySelectorAll("input,select,textarea");
      const data={}; all.forEach(el=>{
        if(!el.name) return;
        if(el.type==="checkbox") data[el.name]=el.checked;
        else if(el.type==="radio"){ if(el.checked) data[el.name]=el.value.trim(); }
        else data[el.name]=el.value.trim();
      }); return data;
    };

    form.addEventListener("submit", async(e)=>{
      e.preventDefault();
      const btn=form.querySelector('button[type="submit"]'); const prev=btn.textContent;
      btn.disabled=true; btn.textContent="Sending...";
      show("",true);

      try {
        const payload=formToJSON(form);
        const res=await fetch(ENDPOINT,{
          method:"POST", headers:{"Content-Type":"application/json"},
          body:JSON.stringify(payload)
        });
        let data={}; try{ data=await res.json(); }catch{}
        if(!res.ok || data.ok===false) throw new Error(data.error||data.message||`HTTP ${res.status}`);
        show("✅ Request sent. We’ll reply soon.",true);
        form.reset();
      } catch(err){
        show("❌ "+(err.message||"Failed to send"));
      } finally {
        btn.disabled=false; btn.textContent=prev;
      }
    });
  })();
  </script>
</body>
</html>